{
  "Impact": "By tricking a user into opening a specifically crafted PNG file within an application that uses libpng, an attacker may be able to cause a denial of service crash. The PNG Development Group has stated that: Such malformed PNG files are not necessarily malevolent (ones have been observed on the Internet that were created by accident) but they will cause a crash anyway.", 
  "CVSS_SecurityRequirementsIR": "", 
  "CVSS_EnvironmentalVector": "", 
  "Title": "libpng malformed cHRM divide-by-zero vulnerability", 
  "DateFirstPublished": "2011-09-22T15:46:56-04:00", 
  "CVSS_AccessVector": "", 
  "CAM_ScoreCurrentWidelyKnown": 0.46575, 
  "IDNumber": "477046", 
  "SystemsAffectedPreamble": "According to The PNG Development Group: Those that use a \"system\" libpng that happens to be libpng-1.5.4 are vulnerable to a divide-by-zero crash. Mozilla products that use the embedded libpng are not vulnerable.", 
  "CVSS_SecurityRequirementsCR": "", 
  "CVSS_Authenication": "", 
  "CVSS_BaseScore": "", 
  "CAM_EaseOfExploitation": "2", 
  "IPProtocol": "", 
  "CERTAdvisory": "", 
  "CVSS_CollateralDamagePotential": "", 
  "Revision": 16, 
  "CVEIDs": "CVE 2011-3328", 
  "VRDA_D1_DirectReport": "1", 
  "CAM_WidelyKnown": "0", 
  "CAM_Population": "15", 
  "Description": "When libpng encounters a cHRM chunk that is malformed it will perform a divide-by-zero causing libpng to crash. This bug was introduced in libpng version 1.5.4 and has been fixed in libpng version 1.5.5.", 
  "CVSS_AccessComplexity": "", 
  "CVSS_SecurityRequirementsAR": "", 
  "Resolution": "Apply an Update This vulnerability is addressed in the following libpng versions: libpng-1.5.5", 
  "Author": "This document was written by Michael Orlando.", 
  "CAM_Exploitation": "0", 
  "DateLastUpdated": "2011-09-23T07:27:00-04:00", 
  "CVSS_IntegrityImpact": "", 
  "VRDA_D1_Population": "3", 
  "CVSS_TemporalVector": "", 
  "CVSS_ReportConfidence": "", 
  "CVSS_ConfidentialityImpact": "", 
  "CVSS_BaseVector": "", 
  "VulnerabilityCount": 1, 
  "CVSS_Exploitability": "", 
  "ThanksAndCredit": "Thanks to Glenn Randers-Pehrson of the PNG Development Group for reporting this vulnerability.", 
  "US-CERTTechnicalAlert": "", 
  "CAM_ScoreCurrentWidelyKnownExploited": 0.87075, 
  "CVSS_TemporalScore": "", 
  "VRDA_D1_Impact": "3", 
  "CVSS_TargetDistribution": "", 
  "CAM_InternetInfrastructure": "3", 
  "CVSS_RemediationLevel": "", 
  "Workarounds": "The PNG Development Group recommends upgrading to libpng-1.5.5. However, if you must continue to use libpng-1.5.4, you can apply the following patch to libpng-1.5.4: --- a/libpng/pngrutil.c\n+++ b/libpng/pngrutil.c\n@@ -1037,12 +1037,15 @@ png_handle_cHRM(png_structp png_ptr, png_infop\ninfo_ptr, png_uint_32 length) png_uint_32 w = y_red + y_green + y_blue; - png_ptr->rgb_to_gray_red_coeff = (png_uint_16)(((png_uint_32)y_red *\n- 32768)/w); - png_ptr->rgb_to_gray_green_coeff = (png_uint_16)(((png_uint_32)y_green\n- * 32768)/w); - png_ptr->rgb_to_gray_blue_coeff = (png_uint_16)(((png_uint_32)y_blue *\n- 32768)/w); + if (w != 0) + png_ptr->rgb_to_gray_red_coeff = (png_uint_16)(((png_uint_32)y_red *\n+ 32768)/w); + png_ptr->rgb_to_gray_green_coeff = (png_uint_16)(((png_uint_32)y_green\n+ * 32768)/w); + png_ptr->rgb_to_gray_blue_coeff = (png_uint_16)(((png_uint_32)y_blue *\n+ 32768)/w); #endif", 
  "ID": "VU#477046", 
  "CVSS_AvailabilityImpact": "", 
  "CAM_ScoreCurrent": 0.06075, 
  "Overview": "libpng crashes when processing malformed cHRM chunks.", 
  "CAM_Impact": "3", 
  "DatePublic": "2011-09-22T00:00:00", 
  "DateCreated": "2011-09-09T08:03:01-04:00", 
  "References": [
    "http://libpng.sf.net/index.html", 
    "ftp://ftp.simplesystems.org/pub/png/src", 
    "https://sourceforge.net/tracker/index.php?func=detail&aid=3406145&group_id=5624&atid=105624"
  ], 
  "Keywords": [
    "libpng", 
    "DoS", 
    "cHRM"
  ], 
  "CVSS_EnvironmentalScore": "", 
  "CAM_AttackerAccessRequired": "12"
}